# Visio2Img 使用指南

## 导出功能

### 导出 TIFF
1. 在 Visio 中选中图形
2. 点击 **Visio2Img** 选项卡 → **导出 TIFF...**
3. 设置导出参数：
   - **DPI**：分辨率（默认 1000）
   - **压缩**：建议使用 LZW 无损压缩
4. 选择保存位置，确认导出

### 导出 PDF
1. 在 Visio 中选中图形
2. 点击 **Visio2Img** 选项卡 → **导出 PDF...**
3. 设置参数并确认

> ⚠️ 导出 PDF 需要安装 [ImageMagick](https://imagemagick.org/script/download.php)

### 快速导出
- **快速导出 TIFF**：一键使用默认设置导出到默认输出路径
- **快速导出 PDF**：一键使用默认设置导出到默认输出路径

快速导出会自动在默认输出路径生成带时间戳命名的文件。

### 上次导出（覆盖）
- **上次导出 TIFF**：直接覆盖上次导出的 TIFF 文件
- **上次导出 PDF**：直接覆盖上次导出的 PDF 文件

修改图形后，一键覆盖，无需重新选择路径。

### 批量导出
将多个选中图形分别导出为单独文件，支持自定义基础文件名和格式。

---

## 配色功能

### 一键填充
1. 在 Visio 中选中一个或多个图形
2. 在 Ribbon 栏的"配色"区域，点击任意色块
3. 选中的图形将立即填充该颜色（自动跳过连接线）

### 配色管理

点击"配色管理"按钮打开设置界面：

![配色管理界面](../fig/palette-manager.png)

**界面说明**：
- **左侧列表**：显示所有配色组，点击选择要编辑的组
- **组名称**：修改后点击输入框外自动保存
- **颜色板**：点击色块选中，然后编辑颜色
- **一键导入**：批量导入 HEX 颜色值

**功能详解**：
- **添加/删除**：支持最多 6 组配色
- **调整顺序**：使用"上移/下移"按钮调整配色组顺序
- **编辑颜色**：
  - 点击色块选中 → 直接输入 HEX 值
  - 点击"打开调色板"使用系统颜色选择器
  - 点击"屏幕取色"从屏幕任意位置（包括 Visio）吸取颜色
- **一键导入**：输入逗号分隔的 HEX 值批量导入（最多 5 个）
  - 示例：`#237B9F, #71BFB2, #AD0B08, #EC817E, #FEE066`
- **自定义组名**：点击输入框外自动保存

### 配色网站推荐
- [学术期刊配色推荐器](http://lcpmgh.com/colors/) - 收集了 Science、Nature 等顶刊的配色方案
- [GitHub 源码](https://github.com/lcpmgh/colors) - 可下载配色数据库
- 使用方法：在网站复制 HEX 颜色值 → 用"一键导入"功能粘贴导入

---

## 快捷键

1. 点击 **设置** 按钮
2. 勾选 **启用键盘快捷键**
3. 点击快捷键输入框，按下想要的快捷键组合
4. 点击 **保存设置**

默认快捷键（需先在设置中启用）：

| 功能 | 默认快捷键 |
|------|-----------|
| 导出 TIFF | Ctrl+Shift+T |
| 导出 PDF | Ctrl+Shift+P |
| 上次导出 | Ctrl+Shift+R |
| 批量导出 | Ctrl+Shift+B |

> ⚠️ 快捷键默认关闭，需要在设置中启用。请注意避免与系统或其他软件的快捷键冲突。

---

## 支持的导出格式

| 格式 | 扩展名 | 类型 | 特点 | 适用场景 |
|------|--------|------|------|----------|
| TIFF | `.tif` | 位图 | 支持 LZW 无损压缩，高质量 | 印刷、存档、论文插图 |
| PNG | `.png` | 位图 | 无损压缩，支持透明背景 | 网页、演示文稿 |
| JPEG | `.jpg` | 位图 | 有损压缩，文件小 | 照片类图像、网页 |
| EMF | `.emf` | 矢量 | Windows 矢量格式，无损缩放 | Office 文档、Word 插图 |
| SVG | `.svg` | 矢量 | 开放矢量格式，可编辑 | 网页、图形设计 |
| PDF | `.pdf` | 矢量 | 通用文档格式（需 ImageMagick） | 打印、分享、存档 |

