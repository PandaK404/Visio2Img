# Visio2Img

å°† Microsoft Visio é€‰ä¸­å›¾å½¢å¯¼å‡ºä¸ºé«˜è´¨é‡å›¾ç‰‡çš„æ’ä»¶ã€‚

> ğŸ“¦ **v1.2.0 é¢„ç¼–è¯‘ç‰ˆæœ¬å·²å‘å¸ƒ**ï¼ˆ2025-12-21ï¼‰ï¼Œæºä»£ç ç‰ˆæœ¬æ•´ç†ä¸­ã€‚  
> ä¸‹è½½ï¼š[Releases](https://github.com/PandaK404/Visio2Img/releases)

## ä¸ºä»€ä¹ˆå¼€å‘è¿™ä¸ªæ’ä»¶ï¼Ÿ

åœ¨ Visio ä¸­å¯¼å‡ºå›¾ç‰‡ä¸€ç›´æ˜¯ä¸€ä»¶ä»¤äººå¤´ç–¼çš„äº‹æƒ…ï¼š

- æ¯æ¬¡å¯¼å‡ºéƒ½è¦é‡å¤ " é€‰æ‹©æ–‡ä»¶å¤¹ â†’ è¾“å…¥æ–‡ä»¶å â†’ é€‰æ‹©æ ¼å¼ " çš„ç¹çæ“ä½œ
- ä¿®æ”¹å›¾å½¢åæƒ³è¦†ç›–åŸæ–‡ä»¶ï¼Œåˆè¦é‡æ–°èµ°ä¸€éå®Œæ•´æµç¨‹
- Visio ä¸æ”¯æŒç›´æ¥å¯¼å‡ºä¸º PDF æ ¼å¼
- æ‰¹é‡å¯¼å‡ºå¤šä¸ªå›¾å½¢æ—¶ï¼Œéœ€è¦é€ä¸ªæ‰‹åŠ¨æ“ä½œ

ä½œä¸ºä¸€åç»å¸¸ï¼ˆå…¶å®ä¹Ÿä¸æ€ä¹ˆç»å¸¸ï¼‰éœ€è¦åœ¨è®ºæ–‡ä¸­æ’å…¥ Visio å›¾å½¢çš„ç”¨æˆ·ï¼Œä½œè€…æ·±å—å…¶è‹¦ï¼Œæ—©å°±æƒ³å¼€å‘ä¸€ä¸ªæ’ä»¶æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚å¥ˆä½•æ—©å¹´è‹¦äºä¸ä¼š C# è¯­è¨€ï¼Œè¿™ä¸ªæƒ³æ³•ä¸€ç›´æ— æ³•å®ç°ã€‚è¿‘æ¥ AI ç¼–ç¨‹åŠ©æ‰‹å¤§è¡Œå…¶é“ï¼Œå€ŸåŠ© AI çš„å¸®åŠ©ï¼Œç»ˆäºå°†è¿™ä¸ªå¤šå¹´çš„æƒ³æ³•å˜æˆäº†ç°å®ã€‚äºæ˜¯ä¾¿æœ‰äº† **Visio2Img**ï¼Œè®©å¯¼å‡ºå›¾ç‰‡å˜å¾—ç®€å•é«˜æ•ˆã€‚

## åŠŸèƒ½ç‰¹æ€§

- âš¡ **å¿«é€Ÿå¯¼å‡º**ï¼šä¸€é”®ä½¿ç”¨é»˜è®¤è®¾ç½®å¯¼å‡ºï¼Œå‘Šåˆ«ç¹çæ“ä½œ
- ğŸ”„ **ä¸Šæ¬¡å¯¼å‡º**ï¼šä¸€é”®è¦†ç›–ä¸Šæ¬¡å¯¼å‡ºçš„æ–‡ä»¶ï¼Œä¿®æ”¹åæ— éœ€é‡æ–°é€‰æ‹©è·¯å¾„
- ğŸ“¦ **æ‰¹é‡å¯¼å‡º**ï¼šå°†å¤šä¸ªé€‰ä¸­å›¾å½¢åˆ†åˆ«å¯¼å‡ºä¸ºå•ç‹¬æ–‡ä»¶
- ğŸ–¼ï¸ **å¤šæ ¼å¼å¯¼å‡º**ï¼šæ”¯æŒ TIFFã€ PNGã€ JPEGã€ EMFã€ SVGã€**PDF**
- ğŸ“‹ **å¤åˆ¶åˆ°å‰ªè´´æ¿**ï¼šå¯¼å‡ºåå¯é€‰æ‹©è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿
- ğŸ¯ **é€‰ä¸­å¯¼å‡º**ï¼šåªå¯¼å‡ºé€‰ä¸­çš„å›¾å½¢ï¼Œè‡ªåŠ¨è£å‰ªè¾¹ç•Œ
- âŒ¨ï¸ **å¿«æ·é”®æ”¯æŒ**ï¼šå¯é…ç½®å…¨å±€å¿«æ·é”®ï¼ˆå¯é€‰ï¼‰
- ğŸ’¾ **è®°ä½è®¾ç½®**ï¼šä¿å­˜å¯¼å‡ºåå¥½è®¾ç½®

## ç•Œé¢é¢„è§ˆ

### Ribbon ç•Œé¢

å®‰è£…åï¼Œåœ¨ Visio ä¸­ä¼šå‡ºç° **Visio2Img** é€‰é¡¹å¡ï¼š

![Ribbon ç•Œé¢ ](fig/ribbon-ui.png)

- **TIFF å¯¼å‡º**ï¼šå¯¼å‡º TIFFã€ä¸Šæ¬¡å¯¼å‡ºï¼ˆè¦†ç›–ï¼‰ã€å¿«é€Ÿå¯¼å‡º
- **PDF å¯¼å‡º**ï¼šå¯¼å‡º PDFã€ä¸Šæ¬¡å¯¼å‡ºï¼ˆè¦†ç›–ï¼‰ã€å¿«é€Ÿå¯¼å‡º
- **å…¶ä»–æ ¼å¼**ï¼š PNGã€ JPEGã€ EMFã€ SVG
- **æ‰¹é‡**ï¼šæ‰¹é‡å¯¼å‡ºå¤šä¸ªå›¾å½¢
- **è®¾ç½®**ï¼šè®¾ç½®ã€å…³äº

### å¯¼å‡ºå¯¹è¯æ¡†

ç‚¹å‡» " å¯¼å‡º TIFF..." æˆ– " å¯¼å‡º PDF..." æŒ‰é’®åå¼¹å‡ºï¼š

![ å¯¼å‡ºå¯¹è¯æ¡† ](fig/export-tiff-dialog.png)

å¯ä»¥è®¾ç½®ï¼š
- **ä¿å­˜æ–‡ä»¶å¤¹**ï¼šé€‰æ‹©å¯¼å‡ºè·¯å¾„
- **æ–‡ä»¶å**ï¼šè‡ªå®šä¹‰æ–‡ä»¶å
- **åˆ†è¾¨ç‡ (DPI)**ï¼šå»ºè®® 300-1000
- **å…¶ä»–é€‰é¡¹**ï¼š LZW å‹ç¼©ã€å¤åˆ¶åˆ°å‰ªè´´æ¿ã€ä¿å­˜ä¸ºé»˜è®¤å€¼

### è®¾ç½®å¯¹è¯æ¡†

ç‚¹å‡» " è®¾ç½® " æŒ‰é’®æ‰“å¼€ï¼š

![ è®¾ç½®å¯¹è¯æ¡† ](fig/settings-dialog.png)

- **å¯¼å‡ºè®¾ç½®**ï¼šé»˜è®¤è¾“å‡ºè·¯å¾„ã€åˆ†è¾¨ç‡ã€å‹ç¼©æ–¹å¼ã€å¯¼å‡ºåæ“ä½œ
- **å¿«æ·é”®è®¾ç½®**ï¼šå¯ç”¨ / é…ç½®å…¨å±€å¿«æ·é”®

### å¯¼å‡ºæˆåŠŸæç¤º

#### TIFF å¯¼å‡ºæˆåŠŸ

![TIFF å¯¼å‡ºæˆåŠŸ ](fig/export-tiff-success.png)

#### PDF å¯¼å‡ºæˆåŠŸ

![PDF å¯¼å‡ºæˆåŠŸ ](fig/export-pdf-success.png)

#### å¿«é€Ÿå¯¼å‡ºæˆåŠŸ

![ å¿«é€Ÿå¯¼å‡ºæˆåŠŸ ](fig/quick-export-success.png)

å¿«é€Ÿå¯¼å‡ºä¼šè‡ªåŠ¨åœ¨é»˜è®¤è¾“å‡ºè·¯å¾„ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶ã€‚

#### ä¸Šæ¬¡å¯¼å‡ºï¼ˆè¦†ç›–ï¼‰æˆåŠŸ

![ ä¸Šæ¬¡å¯¼å‡ºæˆåŠŸ ](fig/repeat-export-success.png)

ç›´æ¥è¦†ç›–ä¸Šæ¬¡å¯¼å‡ºçš„æ–‡ä»¶ï¼Œæ— éœ€é‡æ–°é€‰æ‹©è·¯å¾„ã€‚

#### æ‰¹é‡å¯¼å‡ºå®Œæˆ

![ æ‰¹é‡å¯¼å‡ºå®Œæˆ ](fig/batch-export-success.png)

å°†å¤šä¸ªé€‰ä¸­å›¾å½¢åˆ†åˆ«å¯¼å‡ºä¸ºå•ç‹¬æ–‡ä»¶ã€‚

### æ”¯æŒçš„å¯¼å‡ºæ ¼å¼

| æ ¼å¼ | æ‰©å±•å | ç±»å‹ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|--------|------|------|----------|
| TIFF | `.tif` | ä½å›¾ | æ”¯æŒ LZW æ— æŸå‹ç¼©ï¼Œé«˜è´¨é‡ | å°åˆ·ã€å­˜æ¡£ã€è®ºæ–‡æ’å›¾ |
| PNG | `.png` | ä½å›¾ | æ— æŸå‹ç¼©ï¼Œæ”¯æŒé€æ˜èƒŒæ™¯ | ç½‘é¡µã€æ¼”ç¤ºæ–‡ç¨¿ |
| JPEG | `.jpg` | ä½å›¾ | æœ‰æŸå‹ç¼©ï¼Œæ–‡ä»¶å° | ç…§ç‰‡ç±»å›¾åƒã€ç½‘é¡µ |
| EMF | `.emf` | çŸ¢é‡ | Windows çŸ¢é‡æ ¼å¼ï¼Œæ— æŸç¼©æ”¾ | Office æ–‡æ¡£ã€ Word æ’å›¾ |
| SVG | `.svg` | çŸ¢é‡ | å¼€æ”¾çŸ¢é‡æ ¼å¼ï¼Œå¯ç¼–è¾‘ | ç½‘é¡µã€å›¾å½¢è®¾è®¡ |
| PDF | `.pdf` | çŸ¢é‡ | é€šç”¨æ–‡æ¡£æ ¼å¼ï¼ˆéœ€ ImageMagickï¼‰ | æ‰“å°ã€åˆ†äº«ã€å­˜æ¡£ |

## ç³»ç»Ÿè¦æ±‚

### å¿…éœ€
- Windows 10/11 64 ä½
- Microsoft Visio 2016 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆ 64 ä½ï¼‰
- .NET Framework 4.8
- .NET SDK 6.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆç”¨äºç¼–è¯‘ï¼‰

### å¯é€‰
- [ImageMagick](https://imagemagick.org/script/download.php)ï¼ˆå¯¼å‡º PDF éœ€è¦ï¼‰
  - å®‰è£…æ—¶è¯·å‹¾é€‰ "Add application directory to your system path"

## å®‰è£…

### 1. æ£€æŸ¥ç¯å¢ƒ
```batch
check_environment.bat
```
è¿è¡Œæ­¤è„šæœ¬æ£€æŸ¥ä¾èµ–æ˜¯å¦å·²å®‰è£…ã€‚

### 2. ç¼–è¯‘é¡¹ç›®
```batch
dotnet build --configuration Release
```

### 3. å®‰è£…æ’ä»¶
ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼š
```batch
install.bat
```

### 4. éªŒè¯å®‰è£…
å¯åŠ¨ Visioï¼Œåº”è¯¥èƒ½çœ‹åˆ° **Visio2Img** é€‰é¡¹å¡ã€‚

## ä½¿ç”¨æ–¹æ³•

### å¯¼å‡º TIFF
1. åœ¨ Visio ä¸­é€‰ä¸­å›¾å½¢
2. ç‚¹å‡» **Visio2Img** é€‰é¡¹å¡ â†’ **å¯¼å‡º TIFF...**
3. è®¾ç½®å¯¼å‡ºå‚æ•°ï¼š
   - **DPI**ï¼šåˆ†è¾¨ç‡ï¼ˆé»˜è®¤ 1000 ï¼‰
   - **å‹ç¼©**ï¼šå»ºè®®ä½¿ç”¨ LZW æ— æŸå‹ç¼©
4. é€‰æ‹©ä¿å­˜ä½ç½®ï¼Œç¡®è®¤å¯¼å‡º

### å¯¼å‡º PDF
1. åœ¨ Visio ä¸­é€‰ä¸­å›¾å½¢
2. ç‚¹å‡» **Visio2Img** é€‰é¡¹å¡ â†’ **å¯¼å‡º PDF...**
3. è®¾ç½®å‚æ•°å¹¶ç¡®è®¤

> âš ï¸ å¯¼å‡º PDF éœ€è¦å®‰è£… ImageMagick

### å¿«é€Ÿå¯¼å‡º
- **å¿«é€Ÿå¯¼å‡º TIFF**ï¼šä¸€é”®ä½¿ç”¨é»˜è®¤è®¾ç½®å¯¼å‡ºåˆ°é»˜è®¤è¾“å‡ºè·¯å¾„
- **å¿«é€Ÿå¯¼å‡º PDF**ï¼šä¸€é”®ä½¿ç”¨é»˜è®¤è®¾ç½®å¯¼å‡ºåˆ°é»˜è®¤è¾“å‡ºè·¯å¾„

å¿«é€Ÿå¯¼å‡ºä¼šè‡ªåŠ¨åœ¨é»˜è®¤è¾“å‡ºè·¯å¾„ç”Ÿæˆå¸¦æ—¶é—´æˆ³å‘½åçš„æ–‡ä»¶ã€‚

### ä¸Šæ¬¡å¯¼å‡ºï¼ˆè¦†ç›–ï¼‰
- **ä¸Šæ¬¡å¯¼å‡º TIFF**ï¼šç›´æ¥è¦†ç›–ä¸Šæ¬¡å¯¼å‡ºçš„ TIFF æ–‡ä»¶
- **ä¸Šæ¬¡å¯¼å‡º PDF**ï¼šç›´æ¥è¦†ç›–ä¸Šæ¬¡å¯¼å‡ºçš„ PDF æ–‡ä»¶

ä¿®æ”¹å›¾å½¢åï¼Œä¸€é”®è¦†ç›–ï¼Œæ— éœ€é‡æ–°é€‰æ‹©è·¯å¾„ã€‚

### å¿«æ·é”®
1. ç‚¹å‡» **è®¾ç½®** æŒ‰é’®
2. å‹¾é€‰ **å¯ç”¨é”®ç›˜å¿«æ·é”®**
3. ç‚¹å‡»å¿«æ·é”®è¾“å…¥æ¡†ï¼ŒæŒ‰ä¸‹æƒ³è¦çš„å¿«æ·é”®ç»„åˆ
4. ç‚¹å‡» **ä¿å­˜è®¾ç½®**

é»˜è®¤å¿«æ·é”®ï¼ˆéœ€å…ˆåœ¨è®¾ç½®ä¸­å¯ç”¨ï¼‰ï¼š
| åŠŸèƒ½ | é»˜è®¤å¿«æ·é”® |
|------|-----------|
| å¯¼å‡º TIFF | Ctrl+Shift+T |
| å¯¼å‡º PDF | Ctrl+Shift+P |
| ä¸Šæ¬¡å¯¼å‡º | Ctrl+Shift+R |
| æ‰¹é‡å¯¼å‡º | Ctrl+Shift+B |

> âš ï¸ å¿«æ·é”®é»˜è®¤å…³é—­ï¼Œéœ€è¦åœ¨è®¾ç½®ä¸­å¯ç”¨ã€‚è¯·æ³¨æ„é¿å…ä¸ç³»ç»Ÿæˆ–å…¶ä»–è½¯ä»¶çš„å¿«æ·é”®å†²çªã€‚

## å¸è½½

ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼š
```batch
uninstall.bat
```

## é¡¹ç›®ç»“æ„

```
Visio2Img/
â”œâ”€â”€ Visio2Img.csproj      # é¡¹ç›®æ–‡ä»¶
â”œâ”€â”€ Connect.cs            # COM æ’ä»¶å…¥å£
â”œâ”€â”€ RibbonController.cs   # Ribbon æŒ‰é’®äº‹ä»¶å¤„ç†
â”œâ”€â”€ ImageExporter.cs      # å›¾åƒå¯¼å‡ºæ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ ExportDialog.cs       # å¯¼å‡ºå¯¹è¯æ¡†
â”œâ”€â”€ ExportSettings.cs     # è®¾ç½®æŒä¹…åŒ–
â”œâ”€â”€ SettingsDialog.cs     # è®¾ç½®å¯¹è¯æ¡†
â”œâ”€â”€ BatchExportDialog.cs  # æ‰¹é‡å¯¼å‡ºå¯¹è¯æ¡†
â”œâ”€â”€ KeyboardHook.cs       # å…¨å±€é”®ç›˜é’©å­
â”œâ”€â”€ Program.cs            # ç‹¬ç«‹æµ‹è¯•å…¥å£
â”œâ”€â”€ install.bat           # å®‰è£…è„šæœ¬
â”œâ”€â”€ uninstall.bat         # å¸è½½è„šæœ¬
â”œâ”€â”€ check_environment.bat # ç¯å¢ƒæ£€æŸ¥è„šæœ¬
â”œâ”€â”€ fig/                  # æˆªå›¾
â””â”€â”€ README.md             # æ–‡æ¡£
```

## æŠ€æœ¯ç»†èŠ‚

- **æ¡†æ¶**ï¼š.NET Framework 4.8
- **ç±»å‹**ï¼š COM Add-in (IDTExtensibility2 + IRibbonExtensibility)
- **å›¾åƒå¤„ç†**ï¼š System.Drawing.Imaging
- **PDF è½¬æ¢**ï¼š ImageMagick å‘½ä»¤è¡Œ

## å¼€å‘

### ç¼–è¯‘è¦æ±‚
ç¼–è¯‘æ­¤é¡¹ç›®éœ€è¦åœ¨å¼€å‘æœºå™¨ä¸Šå®‰è£… **Microsoft Visio**ï¼Œå› ä¸ºé¡¹ç›®ä¾èµ– Visio Interop ç¨‹åºé›†ï¼ˆ COM ç±»å‹åº“ï¼‰ã€‚

å¦‚æœæ²¡æœ‰å®‰è£… Visioï¼Œå¯ä»¥åˆ›å»º `lib` æ–‡ä»¶å¤¹å¹¶æ”¾å…¥ä»¥ä¸‹ DLL æ–‡ä»¶ï¼š
- `Microsoft.Office.Interop.Visio.dll`
- `Office.dll`
- `Extensibility.dll`

è¿™äº›æ–‡ä»¶å¯ä»¥ä»å®‰è£…äº† Visio çš„æœºå™¨ä¸Šå¤åˆ¶ã€‚

### ç¼–è¯‘å‘½ä»¤

> âš ï¸ **é‡è¦**ï¼šç¼–è¯‘å‰è¯·å…ˆå…³é—­ Visioï¼Œå¦åˆ™å¯èƒ½å›  DLL è¢«é”å®šè€Œç¼–è¯‘å¤±è´¥ã€‚

```powershell
dotnet build Visio2Img.csproj --configuration Release
```

### è°ƒè¯•
1. ä½¿ç”¨ Debug é…ç½®ç¼–è¯‘
2. è¿è¡Œ `install.bat` æ³¨å†Œè°ƒè¯•ç‰ˆæœ¬
3. åœ¨ Visual Studio ä¸­é™„åŠ åˆ° VISIO.EXE è¿›ç¨‹

## å¸¸è§é—®é¢˜

### Q: å®‰è£…åçœ‹ä¸åˆ°æ’ä»¶é€‰é¡¹å¡ï¼Ÿ
A:
1. ç¡®ä¿ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œäº† `install.bat`
2. ç¡®è®¤ Visio æ˜¯ 64 ä½ç‰ˆæœ¬
3. æ£€æŸ¥ Visio é€‰é¡¹ â†’ åŠ è½½é¡¹ â†’ COM åŠ è½½é¡¹

### Q: å¯¼å‡º PDF å¤±è´¥ï¼Ÿ
A:
1. ç¡®ä¿å®‰è£…äº† ImageMagick
2. ç¡®ä¿ ImageMagick æ·»åŠ åˆ°ç³»ç»Ÿ PATH
3. è¿è¡Œ `check_environment.bat` æ£€æŸ¥

### Q: å¯¼å‡ºçš„å›¾ç‰‡æ¨¡ç³Šï¼Ÿ
A: å°è¯•å¢å¤§ DPI å€¼ï¼Œå°åˆ·è´¨é‡å»ºè®® 300 DPI ä»¥ä¸Šã€‚

## è®¸å¯è¯

MIT License

> **æ³¨æ„**ï¼šè½¬è½½æˆ–åˆ›ä½œè¡ç”Ÿä½œå“æ—¶ï¼Œè¯·é™„ä¸ŠåŸé¡¹ç›®é“¾æ¥ã€‚

## ä½œè€…

**PandaK404**

GitHub: [github.com/PandaK404/Visio2Img](https://github.com/PandaK404/Visio2Img)

å¦‚æœè§‰å¾—å¥½ç”¨ï¼Œè®°å¾—ç‚¹ â­ Starï¼
